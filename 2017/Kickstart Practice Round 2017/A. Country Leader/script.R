###############################################################################
###############################################################################
###############################################################################

## I am loading input data ----------------------------------------------------

my_input <- file.choose()
my_data <- readLines(my_input)


## ----------------------------------------------------------------------------

###############################################################################

## I am changing a working directory ------------------------------------------

setwd(
    gsub("(.*\\\\)(.*)", "\\1", my_input)
)


## ----------------------------------------------------------------------------

###############################################################################

## helper functions -----------------------------------------------------------

solveTheCase <- function(my_case){
    
    # '''
    # Returns a solution for one case of the input data.
    # '''
	
    my_lengths <- unlist(lapply(
        lapply(
	    lapply(
                my_case,
                function(x) strsplit(x, split = "")[[1]]
            ),
	    function(x) x[x != " "]
	),
        function(x) length(unique(x))
    ))
    
    return(
        sort(my_case[my_lengths == max(my_lengths)])[1]
    )
    
}


## ----------------------------------------------------------------------------

###############################################################################

## flow control ---------------------------------------------------------------

if(
    sum(
        as.numeric(
            my_data[-1][
                suppressWarnings(which(!is.na(as.numeric(my_data[-1]))))
            ]
        )
    ) + sum(
        length(
            my_data[-1][
                suppressWarnings(which(!is.na(as.numeric(my_data[-1]))))
            ]
        )
    ) != length(my_data) - 1
){
    stop("Number of cases is fishy.", call. = FALSE)
}


## ----------------------------------------------------------------------------

###############################################################################

## core computations ----------------------------------------------------------

my_output <- NULL
i <- 0
j <- 2

while(i < as.integer(my_data[1])){

    my_case <- my_data[(j + 1):(j + as.integer(my_data[j]))]

    my_output <- c(
        my_output,
        paste(
            "Case #", i + 1, ": ", solveTheCase(my_case), sep = ""
        )
    )
    
    j <- j + 1 + as.integer(my_data[j])
    i <- i + 1
    
}


## ----------------------------------------------------------------------------

###############################################################################

## I am giving an output ------------------------------------------------------

writeLines(
    my_output,
    con = gsub(
        ".in",
        "-out.in",
        gsub("(.*\\\\)(.*)", "\\2", my_input)
    )
)


## ----------------------------------------------------------------------------

###############################################################################
###############################################################################
###############################################################################






